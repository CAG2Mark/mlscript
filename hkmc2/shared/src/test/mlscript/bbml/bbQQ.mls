:bbml


`42
//│ Type: CodeBase[out Int, ⊥, ?]

:p
:fixme // this should created a quoted keyword
`false
//│ |`|false|
//│ Parsed:
//│ 	Quoted(Ident(false))
//│ ╔══[ERROR] Name not found: false
//│ ║  l.9: 	`false
//│ ╙──     	 ^^^^^
//│ ═══[ERROR] Cannot quote Error
//│ Type: CodeBase[⊥, ⊥, ?]

`"rua"
//│ Type: CodeBase[out Str, ⊥, ?]

`3.14
//│ Type: CodeBase[out Num, ⊥, ?]


x `=> x
//│ Type: CodeBase[out α0_3 -> α0_3, ⊥, ?]

x `=> `42
//│ Type: CodeBase[out ⊤ -> Int, ⊥, ?]

:e
x `=> 42
//│ ╔══[ERROR] Type error in unquoted term
//│ ║  l.33: 	x `=> 42
//│ ║        	      ^^
//│ ╙── because: cannot constrain  Int  <:  CodeBase[out α12_3, out α13_3, ?]
//│ Type: CodeBase[out ⊤ -> ⊥, ⊥, ?]


f `=> x `=> f`(x)
//│ Type: CodeBase[out (α25_3 -> α26_3) -> (α25_3 -> α26_3), ⊥, ?]


x `=> y `=> x `+ y
//│ Type: CodeBase[out Int -> (Int -> Int), ⊥, ?]


(x, y) `=> x `+ y
//│ Type: CodeBase[out (Int, Int) -> Int, ⊥, ?]

(x, y, z) `=> x `+ y `+ z
//│ Type: CodeBase[out (Int, Int, Int) -> Int, ⊥, ?]

f `=> x `=> y `=> f`(x, y)
//│ Type: CodeBase[out ((α97_3, α99_3) -> α100_3) -> (α97_3 -> (α99_3 -> α100_3)), ⊥, ?]

`let x = `42 `in x
//│ Type: CodeBase[out Int, ⊥, ?]

:e
`let x = 42 `in x
//│ ╔══[ERROR] Type error in unquoted term
//│ ║  l.62: 	`let x = 42 `in x
//│ ║        	         ^^
//│ ╙── because: cannot constrain  Int  <:  CodeBase[out α122_2, out α123_2, ?]
//│ Type: CodeBase[⊥, ⊥, ?]

:e
`let x = `0 `in 1
//│ ╔══[ERROR] Type error in unquoted term
//│ ║  l.70: 	`let x = `0 `in 1
//│ ║        	                ^
//│ ╙── because: cannot constrain  Int  <:  CodeBase[out α131_3, out α132_3, ?]
//│ Type: CodeBase[⊥, ⊥, ?]


:fixme
`if `true then `true else `false
//│ ╔══[ERROR] Name not found: true
//│ ║  l.79: 	`if `true then `true else `false
//│ ╙──      	     ^^^^
//│ ╔══[ERROR] Name not found: true
//│ ║  l.79: 	`if `true then `true else `false
//│ ╙──      	                ^^^^
//│ ╔══[ERROR] Name not found: false
//│ ║  l.79: 	`if `true then `true else `false
//│ ╙──      	                           ^^^^^
//│ ═══[ERROR] Cannot quote IfLike(keyword 'if',Let($scrut@80,Unquoted(Quoted(Error)),Cons(Branch(Ref($scrut@80),LitPat(BoolLit(true)),Else(Unquoted(Quoted(Error)))),Else(Unquoted(Quoted(Error))))))
//│ Type: CodeBase[⊥, ⊥, ?]


:fixme
x `=> `if x `== `0.0 then `1.0 else x
//│ ═══[ERROR] Cannot quote IfLike(keyword 'if',Let($scrut@84,Unquoted(Quoted(App(Ref(.==),Tup(List(Fld(‹›,Unquoted(Ref(x@82)),None), Fld(‹›,Unquoted(Quoted(Lit(DecLit(0.0)))),None)))))),Cons(Branch(Ref($scrut@84),LitPat(BoolLit(true)),Else(Unquoted(Quoted(Lit(DecLit(1.0)))))),Else(Unquoted(Ref(x@82))))))
//│ Type: CodeBase[out ⊤ -> ⊥, ⊥, ?]

run(`1)
//│ Type: Int

:e
run(1)
//│ ╔══[ERROR] Type error in integer literal with expected type CodeBase[out α140_1, ⊥, ?]
//│ ║  l.102: 	run(1)
//│ ║         	    ^
//│ ╙── because: cannot constrain  Int  <:  CodeBase[out α140_1, ⊥, ?]
//│ Type: ⊥

:e
x `=> run(x)
//│ ╔══[ERROR] Type error in reference with expected type CodeBase[out α143_3, ⊥, ?]
//│ ║  l.110: 	x `=> run(x)
//│ ║         	          ^
//│ ╟── because: cannot constrain  CodeBase[α141_3, <α>142_3, ⊥]  <:  CodeBase[out α143_3, ⊥, ?]
//│ ╙── because: cannot constrain  D( <α>142_3 )  <:  ⊥
//│ Type: CodeBase[out CodeBase[out α144_3, ?, ?] -> α144_3, out α146_2, ?]

:e
`let x = `42 `in run(x)
//│ ╔══[ERROR] Type error in reference with expected type CodeBase[out α150_3, ⊥, ?]
//│ ║  l.119: 	`let x = `42 `in run(x)
//│ ║         	                     ^
//│ ╟── because: cannot constrain  CodeBase[α147_2, <α>149_3, ⊥]  <:  CodeBase[out α150_3, ⊥, ?]
//│ ╙── because: cannot constrain  D( <α>149_3 )  <:  ⊥
//│ ╔══[ERROR] Type error in unquoted term
//│ ║  l.119: 	`let x = `42 `in run(x)
//│ ║         	                 ^^^^^^
//│ ╟── because: cannot constrain  α150_3  <:  CodeBase[out α151_3, out α152_3, ?]
//│ ╟── because: cannot constrain  α150_3  <:  ¬(~{CodeBase[out α151_3, out α152_3, ?]})
//│ ╟── because: cannot constrain  α147_2  <:  ¬(~{CodeBase[out α151_3, out α152_3, ?]})
//│ ╟── because: cannot constrain  α147_2  <:  CodeBase[out α153_2, out α154_2, ?]
//│ ╙── because: cannot constrain  Int  <:  CodeBase[out α153_2, out α154_2, ?]
//│ Type: CodeBase[⊥, ⊥, ?]
