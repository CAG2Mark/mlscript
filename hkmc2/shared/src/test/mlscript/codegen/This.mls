:js


:sjs
fun test(x) =
  [this.a, x]
//│ JS:
//│ function test(...args) {
//│   globalThis.Predef.checkArgs("test", 1, true, args.length);
//│   let x = args[0];
//│   let selRes, tmp;
//│   selRes = globalThis.a;
//│   if (selRes === undefined) {
//│     throw new globalThis.Error("Access to required field 'a' yielded 'undefined'");
//│   } else {
//│     tmp = selRes;
//│   }
//│   return [
//│     tmp,
//│     x
//│   ];
//│ }
//│ null

:re
test(123)
//│ ═══[RUNTIME ERROR] Error: Access to required field 'a' yielded 'undefined'

val a = 1
//│ a = 1

test(123)
//│ = [ 1, 123 ]

:sjs
module Test with
  val a = 2
  fun test1(x) =
    test(x)
  fun test2(x) =
    [this.a, x]
//│ JS:
//│ const Test$class = class Test {
//│   constructor() {
//│     this.a = 2;
//│   }
//│   test1(...args) {
//│     globalThis.Predef.checkArgs("test1", 1, true, args.length);
//│     let x = args[0];
//│     return globalThis.test(x);
//│   } 
//│   test2(...args1) {
//│     globalThis.Predef.checkArgs("test2", 1, true, args1.length);
//│     let x1 = args1[0];
//│     let selRes, tmp;
//│     selRes = this.a;
//│     if (selRes === undefined) {
//│       throw new globalThis.Error("Access to required field 'a' yielded 'undefined'");
//│     } else {
//│       tmp = selRes;
//│     }
//│     return [
//│       tmp,
//│       x1
//│     ];
//│   }
//│   toString() { return "Test"; }
//│ };
//│ this.Test = new Test$class;
//│ this.Test.class = Test$class;
//│ null


Test.test1(123)
//│ = [ 1, 123 ]

Test.test2(123)
//│ = [ 2, 123 ]





