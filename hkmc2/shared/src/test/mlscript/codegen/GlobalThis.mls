:js


globalThis
//│ > <ref *1> Object [global] {
//│ >   global: [Circular *1],
//│ >   clearImmediate: [Function: clearImmediate],
//│ >   setImmediate: [Function: setImmediate] {
//│ >     [Symbol(nodejs.util.promisify.custom)]: [Getter]
//│ >   },
//│ >   clearInterval: [Function: clearInterval],
//│ >   clearTimeout: [Function: clearTimeout],
//│ >   setInterval: [Function: setInterval],
//│ >   setTimeout: [Function: setTimeout] {
//│ >     [Symbol(nodejs.util.promisify.custom)]: [Getter]
//│ >   },
//│ >   queueMicrotask: [Function: queueMicrotask],
//│ >   structuredClone: [Function: structuredClone],
//│ >   atob: [Getter/Setter],
//│ >   btoa: [Getter/Setter],
//│ >   performance: [Getter/Setter],
//│ >   fetch: [Function: fetch],
//│ >   navigator: [Getter],
//│ >   crypto: [Getter]
//│ = }


// FIXME prevent rebinding of this name
let globalThis = "oops"
//│ globalThis = 'oops'

globalThis
//│ = 'oops'


// * This one uses `this.Error` so it's fine
:re
if false then 0
//│ ═══[RUNTIME ERROR] Error: match error

// * This one uses `globalThis.Error`
// * Notice the failed exception throw
:re
fun foo() =
  if false then 0
foo()
//│ ═══[RUNTIME ERROR] TypeError: globalThis.Error is not a constructor


