:js

:import PredefJS.mls
//│ Imported 1 member(s)


:elt
if true then 1 else 0
//│ Elaborated tree:
//│ Blk:
//│   stats = Nil
//│   res = If of Let:
//│     sym = $scrut@24
//│     term = Lit of BoolLit of true
//│     tail = Cons: \
//│     head = Branch:
//│       scrutinee = Ref of $scrut@24
//│       pattern = LitPat of BoolLit of true
//│       continuation = Else of Lit of IntLit of 1
//│     tail = Else of Lit of IntLit of 0
//│ = 1


:sjs
let f = x => if x then log("ok") else log("ko")
//│ JS:
//│ this.f = (x) => { if (x) { return log("ok") } else { return log("ko") } }; undefined
//│ f = [Function (anonymous)]

f(true)
//│ > ok

f(false)
//│ > ko


:sjs
let f = x => log((if x then "ok" else "ko") + "!")
//│ JS:
//│ this.f = (x) => {
//│   let tmp, tmp1;
//│   if (x) {
//│     tmp = "ok";
//│   } else {
//│     tmp = "ko";
//│   }
//│   tmp1 = tmp + "!";
//│   return log(tmp1)
//│ };
//│ undefined
//│ f = [Function (anonymous)]

:sjs
let f = x => log((if x and x then "ok" else "ko") + "!")
//│ JS:
//│ this.f = (x) => {
//│   let tmp, tmp1;
//│   if (x) {
//│     if (x) {
//│       tmp = "ok";
//│     } else {
//│       tmp = "ko";
//│     }
//│   } else {
//│     tmp = "ko";
//│   }
//│   tmp1 = tmp + "!";
//│   return log(tmp1)
//│ };
//│ undefined
//│ f = [Function (anonymous)]
// --- What we want ---
// this.f = (x) => {
//   let tmp, tmp1, flag;
//   if (x) {
//     if (x) {
//       tmp = "ok";
//     } else {
//       flag = 1;
//     }
//   } else {
//     flag = 1;
//   }
//   if (flag === 1) {
//     tmp = "ko";
//   }
//   tmp1 = tmp + "!";
//   return log(tmp1)
// };
// undefined
// f = [Function (anonymous)]

f(true)
//│ > ok!

f(false)
//│ > ko!


x => if x > 0 then log("Hi") else log("Bye")
//│ = [Function (anonymous)]

x => log(if true then "Hi" else "Bye")
//│ = [Function (anonymous)]

x => log(if x + 1 > 0 then "Hi" else "Bye")
//│ = [Function (anonymous)]

x =>
  let str = concat(if x + 1 > 0 then "Hello" else "Bye", "World")
  log(str)
//│ = [Function (anonymous)]


